<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hobbits Heladeras Comunitarias</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link href="/donacionVianda/css/donacionViandaEstilos.css" rel="stylesheet">
</head>

<body>
  <header>
    <div class="header-container d-flex justify-content-between align-items-center">
      <img class="img-logo" src="/donacionVianda/img/logov3.png" alt="logo">
      <nav class="main-nav">
      </nav>

      <!-- Dropdown -->
      <div class="dropdown">
        <button class="btn btn-settings dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
          aria-expanded="false">
          <img src="/donacionVianda/img/settings.png" alt="Settings" class="settings-icon">
        </button>
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
          <li><button onclick="location.href='/visualizadorReporteSemanal/html/visualizadorReporteSemanal.html'"
              class="dropdown-item">Ver reporte semanal</button></li>
          <li><button class="dropdown-item">Opción 2</button></li>
          <li><button class="dropdown-item">Opción 3</button></li>
        </ul>
      </div>
    </div>
  </header>
  <form class="row g-3 mx-5 my-5" method="post" action="/solicitarDonacionVianda">
    <div class="col-md-6">
      <label for="inputComida" class="form-label">Ingrese nombre de comida que desea donar</label>
      <input type="text" class="form-control" id="inputComida" name="inputComida" required>
    </div>
    <div class="col-md-6">
      <label for="inputFechaVencimiento" class="form-label">Ingrese fecha de vencimiento</label>
      <input type="date" class="form-control" id="inputFechaVencimiento" name="inputFechaVencimiento">
    </div>
    <div class="col-12">
      <label for="inputHeladera" class="form-label">Seleccione la heladera en la que desea donar la vianda</label>

        <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle w-100 text-start" type="button" id="menuHeladera" data-bs-toggle="dropdown" aria-expanded="false">
                Seleccione una heladera
            </button>
            <input type="hidden" id="selectedHeladeraId" name="selectedHeladeraId">

            <ul class="dropdown-menu w-100" id="dropdownHeladeras" aria-labelledby="menuHeladera">
                <!-- Las opciones serán cargadas dinámicamente aquí -->
            </ul>
        </div>

    </div>

      <script>
          // URL de la API
          const apiUrl = '/api/heladeras';

          // Referencias a los elementos
          const menuHeladera = document.getElementById('menuHeladera');
          const dropdownHeladeras = document.getElementById('dropdownHeladeras');

          // Función para cargar las heladeras
          async function cargarHeladeras() {
              try {
                  // Fetch a la API
                  const response = await fetch(apiUrl);
                  if (!response.ok) {
                      throw new Error('Error al obtener las heladeras');
                  }

                  // Convertir la respuesta a JSON
                  const heladeras = await response.json();

                  // Generar las opciones dinámicamente
                  heladeras.forEach(heladera => {
                      const li = document.createElement('li');
                      li.innerHTML = `
          <a class="dropdown-item d-flex align-items-center" href="#" data-id="${heladera.id}">
            <img src="https://cdn-icons-png.flaticon.com/512/4151/4151152.png" alt="Ícono" class="me-2">
            <div>
              <strong>${heladera.nombre}</strong><br>
              <small>ID: ${heladera.idHeladera}</small>
            </div>
          </a>
        `;

                      // Agregar evento de selección
                      li.querySelector('a').addEventListener('click', function (event) {
                          event.preventDefault(); // Evitar el comportamiento predeterminado del enlace

                          // Actualizar el texto del botón principal
                          menuHeladera.innerHTML = `
        <img src="https://via.placeholder.com/20" alt="Ícono" class="me-2">
        <strong>${heladera.nombre}</strong><br>
        <small>ID: ${heladera.idHeladera}</small>
    `;

                          // Actualizar el campo oculto con el ID seleccionado
                          document.getElementById('selectedHeladeraId').value = heladera.idHeladera;
                      });

                      // Añadir la opción al menú desplegable
                      dropdownHeladeras.appendChild(li);
                  });
              } catch (error) {
                  console.error('Error al cargar las heladeras:', error);
              }
          }

          // Llamar a la función para cargar las heladeras al cargar la página
          cargarHeladeras();
      </script>

      <style>
          /* Asegura que los íconos sean consistentes */
          .dropdown-item img {
              width: 20px; /* Ancho máximo */
              height: 20px; /* Alto máximo */
              object-fit: contain; /* Asegura que la imagen mantenga su proporción */
              margin-right: 8px; /* Espaciado entre el ícono y el texto */
          }
      </style>
    <div class="col-md-6">
      <label for="inputCalorias" class="form-label">Ingrese calorias de la comida (cal)</label>
      <input type="number" class="form-control" id="inputCalorias" name="inputCalorias">
    </div>
    <div class="col-md-6">
      <label for="inputPeso" class="form-label">Ingrese peso de la vianda (gramos)</label>
      <input type="number" class="form-control" id="inputPeso" name="inputPeso">
    </div>
    <div class="col-12">
      <button type="submit" class="btn btn-primary">Cargar donación de vianda</button>
    </div>
  </form>
  <footer>Empresas que colaboran con nosotros:
    <img src="https://via.placeholder.com/20" alt="Logo de empresa A">
    <img src="https://via.placeholder.com/20" alt="Logo de empresa B">
    <img src="https://via.placeholder.com/20" alt="Logo de empresa C">
    <img src="https://via.placeholder.com/20" alt="Logo de empresa D">
  </footer>

</body>

</html>
<script src="../js/inicioSesion.js" charset="utf-8"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>